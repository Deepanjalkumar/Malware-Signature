import requests,json
from elasticsearch import Elasticsearch
es = Elasticsearch('http://192.168.1.128:9200')

headers={
}

data=requests.get(url="https://www.virustotal.com/api/v3/files/7F52A1B5ED77D701595F1DE3543C7C4567B521EFCAF5EA12EEA93F55BA1203D1", headers=headers)

new_data=data.json()["data"]
id=new_data["id"]
type=new_data["type"]
attributes=new_data["attributes"]
type_description=attributes["type_description"]
vhash=attributes["vhash"]
md5=attributes["md5"]
meaningful_name=attributes["meaningful_name"]
sha256=attributes["sha256"]
authentihash=attributes["authentihash"]
type_tag=attributes["type_tag"]
type_extension=attributes["type_extension"]
magic=attributes["magic"]
sha1=attributes["sha1"]
sigma_analysis_summary=attributes["sigma_analysis_summary"]["Sigma Integrated Rule Set (GitHub)"]
sigma_analysis_stats=attributes["sigma_analysis_stats"]
packers=attributes["packers"]["PEiD"]

pe_info=attributes["pe_info"]
imphash=pe_info["imphash"]
machine_type=pe_info["machine_type"]
entry_point=pe_info["entry_point"]
signature_info=attributes["signature_info"]
product=signature_info["product"]
description=signature_info["description"]
original_name=signature_info["original name"]
file_version=signature_info["file version"]
internal_name=signature_info["internal name"]

tags=attributes["tags"]


#Behavoior analysis
#Sandbox
sandbox_verdicts=attributes["sandbox_verdicts"]
Yomi_Hunter=sandbox_verdicts["Yomi Hunter"]
Yomi_Hunter_category=Yomi_Hunter["category"]
Yomi_Hunter_sandbox_name=Yomi_Hunter["sandbox_name"]
Yomi_Hunter_malware_classification=Yomi_Hunter["malware_classification"]

C2AE=sandbox_verdicts["C2AE"]
C2AE_category=C2AE["category"]
C2AE_confidence=C2AE["confidence"]
C2AE_sandbox_name=C2AE["sandbox_name"]
C2AE_malware_classification=C2AE["malware_classification"]
C2AE_malware_names=C2AE["malware_names"]

